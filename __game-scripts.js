var LoadExternalImage=pc.createScript("loadExternalImage");LoadExternalImage.attributes.add("imageUrl",{type:"string"}),LoadExternalImage.prototype.initialize=function(){var e=this;this.app.loader.getHandler("texture").crossOrigin="anonymous";var a=new pc.Asset("myTexture","texture",{url:this.imageUrl});this.app.assets.add(a),a.on("error",(function(e){console.log(e)})),a.on("load",(function(a){var t=e.entity.model.material.clone();t.diffuseMap=a.resource,t.update(),e.entity.model.material=t})),this.app.assets.load(a)},LoadExternalImage.prototype.update=function(e){};var FirstPersonMovement=pc.createScript("firstPersonMovement");FirstPersonMovement.attributes.add("camera",{type:"entity"}),FirstPersonMovement.attributes.add("power",{type:"number"}),FirstPersonMovement.attributes.add("lookSpeed",{type:"number"}),FirstPersonMovement.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3;this.app.mouse.on("mousemove",this._onMouseMove,this),this.lastTouchPoint=new pc.Vec2;var e=this.app.touch;e&&(e.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),e.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),e.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),e.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)),this.entity.collision||console.error("First Person Movement script needs to have a 'collision' component"),this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("First Person Movement script needs to have a DYNAMIC 'rigidbody' component")},FirstPersonMovement.prototype.update=function(e){this.camera||this._createCamera();var t=this.force,o=this.app,s=this.camera.forward,i=this.camera.right,r=0,n=0;o.keyboard.isPressed(pc.KEY_A)&&(r-=i.x,n-=i.z),o.keyboard.isPressed(pc.KEY_D)&&(r+=i.x,n+=i.z),o.keyboard.isPressed(pc.KEY_W)&&(r+=s.x,n+=s.z),o.keyboard.isPressed(pc.KEY_S)&&(r-=s.x,n-=s.z),0!==r&&0!==n&&(t.set(r,0,n).normalize().scale(this.power),this.entity.rigidbody.applyForce(t)),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)},FirstPersonMovement.prototype._onMouseMove=function(e){(pc.Mouse.isPointerLocked()||e.buttons[0])&&(this.eulers.x-=this.lookSpeed*e.dx,this.eulers.y-=this.lookSpeed*e.dy)},FirstPersonMovement.prototype.onTouchStart=function(e){var t=e.touches[0];this.lastTouchPoint.set(t.x,t.y),this.MOVE_SCALE=1},FirstPersonMovement.prototype.onTouchMove=function(e){var t=e.touches[0],o=t.x-this.lastTouchPoint.x,s=t.y-this.lastTouchPoint.y;this.eulers.x-=this.lookSpeed*o,this.eulers.y-=this.lookSpeed*s,this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0),this.lastTouchPoint.set(t.x,t.y),console.log("touch move")},FirstPersonMovement.prototype._createCamera=function(){this.camera=new pc.Entity,this.camera.setName("First Person Camera"),this.camera.addComponent("camera"),this.entity.addChild(this.camera),this.camera.translateLocal(0,.5,0)},FirstPersonMovement.prototype.onTouchEnd=function(e){e.event.preventDefault()},FirstPersonMovement.prototype.updateFromScreen=function(e){this.cameraEntity.camera.screenToWorld(e.x,e.y,5,this.pos),this.entity.setPosition(this.pos)};var MultitouchInput=pc.createScript("multitouchInput");MultitouchInput.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),MultitouchInput.attributes.add("lineColor",{type:"rgba",title:"Line Color"}),MultitouchInput.DEFAULT_DISTANCE_FROM_CAMERA=4,MultitouchInput.prototype.initialize=function(){var t=this.app.touch;t&&(t.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),t.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),t.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),t.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)),this.activeTouches=[],this.freeTouches=[]},MultitouchInput.prototype.update=function(t){for(var o=1;o<this.activeTouches.length;o+=1){var i=this.activeTouches[o-1],e=this.activeTouches[o];this.app.renderLine(i.position,e.position,this.lineColor)}},MultitouchInput.prototype.addTouchWorldPosition=function(t){var o=null;(o=this.freeTouches.length>0?this.freeTouches.pop():{id:0,position:new pc.Vec3}).id=t.id,this.cameraEntity.camera.screenToWorld(t.x,t.y,MultitouchInput.DEFAULT_DISTANCE_FROM_CAMERA,o.position),this.activeTouches.push(o)},MultitouchInput.prototype.updateTouchWorldPosition=function(t){for(var o=0;o<this.activeTouches.length;o+=1){var i=this.activeTouches[o];if(t.id==i.id)return void this.cameraEntity.camera.screenToWorld(t.x,t.y,MultitouchInput.DEFAULT_DISTANCE_FROM_CAMERA,i.position)}},MultitouchInput.prototype.removeTouchWorldPosition=function(t){var o=-1,i=0;for(i=0;i<this.activeTouches.length;i+=1){var e=this.activeTouches[i];if(t.id==e.id){o=i;break}}if(-1!=o){var u=this.activeTouches.splice(o,1);for(i=0;i<u.length;i+=1)this.freeTouches.push(u[i])}},MultitouchInput.prototype.onTouchStart=function(t){for(var o=t.changedTouches,i=0;i<o.length;i+=1)this.addTouchWorldPosition(o[i])},MultitouchInput.prototype.onTouchMove=function(t){for(var o=t.changedTouches,i=0;i<o.length;i+=1)this.updateTouchWorldPosition(o[i])},MultitouchInput.prototype.onTouchEnd=function(t){for(var o=t.changedTouches,i=0;i<o.length;i+=1)this.removeTouchWorldPosition(o[i])},MultitouchInput.prototype.onTouchCancel=function(t){for(var o=t.changedTouches,i=0;i<o.length;i+=1)this.removeTouchWorldPosition(o[i])};var LoadExternalImageMesh=pc.createScript("loadExternalImageMesh");LoadExternalImageMesh.prototype.initialize=function(){},LoadExternalImageMesh.prototype.update=function(e){};var VirtualSticks=pc.createScript("virtualSticks");VirtualSticks.attributes.add("deadZone",{type:"number",default:.3}),VirtualSticks.attributes.add("pixelRange",{type:"number",default:120}),VirtualSticks.prototype.initialize=function(){this.leftTouch=-1,this.rightTouch=-1,this.leftOrigin=new pc.Vec2,this.leftX=0,this.leftY=0,this.rightOrigin=new pc.Vec2,this.rightX=0,this.rightY=0,this.left=this.entity.findByName("Left"),this.leftStick=this.left.findByName("Stick"),this.right=this.entity.findByName("Right"),this.rightStick=this.right.findByName("Stick"),this.left.enabled=!1,this.right.enabled=!1;var t=this.app.graphicsDevice.canvas;t.addEventListener("touchstart",function(i){for(var e=i.changedTouches,h=this.rightStick.script.sprite.maxResHeight/t.clientHeight,s=0;s<e.length;s++){var a=e[s],r=a.pageX,c=a.pageY;r<t.clientWidth/2?-1===this.leftTouch&&(this.leftTouch=a.identifier,this.left.enabled=!0,this.left.script.sprite.x=r*h,this.left.script.sprite.y=-c*h,this.leftStick.script.sprite.x=r*h,this.leftStick.script.sprite.y=-c*h,this.leftOrigin.set(r,c)):-1===this.rightTouch&&(this.rightTouch=a.identifier,this.right.enabled=!0,this.right.script.sprite.x=r*h,this.right.script.sprite.y=-c*h,this.rightStick.script.sprite.x=r*h,this.rightStick.script.sprite.y=-c*h,this.rightOrigin.set(r,c))}}.bind(this),!1),t.addEventListener("touchend",function(t){for(var i=t.changedTouches,e=0;e<i.length;e++){i[e].identifier===this.leftTouch?(this.left.enabled=!1,this.leftTouch=-1,this.leftOrigin.set(0,0),this.leftX=0,this.leftY=0):(this.right.enabled=!1,this.rightTouch=-1,this.rightOrigin.set(0,0),this.rightX=0,this.rightY=0)}}.bind(this),!1),t.addEventListener("touchmove",function(i){for(var e=i.changedTouches,h=this.rightStick.script.sprite.maxResHeight/t.clientHeight,s=0;s<e.length;s++){var a,r,c=e[s],n=c.pageX,p=c.pageY;this.leftTouch===c.identifier?(this.leftStick.script.sprite.x=n*h,this.leftStick.script.sprite.y=-p*h,a=pc.math.clamp(this.leftOrigin.x-n,-this.pixelRange,this.pixelRange)/this.pixelRange,this.leftX=a>0?pc.math.clamp(a-this.deadZone,0,1)/(1-this.deadZone):pc.math.clamp(a+this.deadZone,0,-1)/(1-this.deadZone),r=pc.math.clamp(this.leftOrigin.y-p,-this.pixelRange,this.pixelRange)/this.pixelRange,this.leftY=r>0?pc.math.clamp(r-this.deadZone,0,1)/(1-this.deadZone):pc.math.clamp(r+this.deadZone,0,-1)/(1-this.deadZone)):this.rightTouch===c.identifier&&(this.rightStick.script.sprite.x=n*h,this.rightStick.script.sprite.y=-p*h,a=pc.math.clamp(this.rightOrigin.x-n,-this.pixelRange,this.pixelRange)/this.pixelRange,this.rightX=a>0?pc.math.clamp(a-this.deadZone,0,1)/(1-this.deadZone):pc.math.clamp(a+this.deadZone,0,-1)/(1-this.deadZone),r=pc.math.clamp(this.rightOrigin.y-p,-this.pixelRange,this.pixelRange)/this.pixelRange,this.rightY=r>0?pc.math.clamp(r-this.deadZone,0,1)/(1-this.deadZone):pc.math.clamp(r+this.deadZone,0,-1)/(1-this.deadZone))}}.bind(this),!1)},VirtualSticks.prototype.update=function(t){},VirtualSticks.prototype.swap=function(t){};var Sprite=pc.createScript("sprite");Sprite.attributes.add("textureAsset",{type:"asset",assetType:"texture",description:"The sprite texture"}),Sprite.attributes.add("pos",{type:"vec2",description:"The coordinate in pixels",placeholder:["x","y"]}),Sprite.attributes.add("size",{type:"vec2",description:"The size of sprite in pixels",placeholder:["w","h"],default:[128,128]}),Sprite.attributes.add("depth",{type:"number",description:"The z depth of the sprite compared to other sprites",default:1}),Sprite.attributes.add("uPercentage",{type:"number",description:"The horizontal texture percentage that is visible (used for progress bars)",default:1,min:0,max:1}),Sprite.attributes.add("vPercentage",{type:"number",description:"The vertical texture percentage that is visible (used for progress bars)",default:1,min:0,max:1}),Sprite.attributes.add("anchor",{type:"number",default:0,description:"The anchor of the sprite related to the screen bounds",enum:[{topLeft:0},{top:1},{topRight:2},{left:3},{center:4},{right:5},{bottomLeft:6},{bottom:7},{bottomRight:8}]}),Sprite.attributes.add("pivot",{type:"number",default:0,description:"The pivot point of the sprite",enum:[{topLeft:0},{top:1},{topRight:2},{left:3},{center:4},{right:5},{bottomLeft:6},{bottom:7},{bottomRight:8}]}),Sprite.attributes.add("tint",{type:"rgba",description:"A color that is multiplied with the current color of the sprite",default:[1,1,1,1]}),Sprite.attributes.add("maxResHeight",{type:"number",default:720,description:"The maximum resolution height of the application. Used to scale the sprite accordingly."}),Sprite.shader=null,Sprite.vertexFormat=null,Sprite.resolution=new pc.Vec2,Sprite.prototype.initialize=function(){var e=document.getElementById("application-canvas");this.userOffset=new pc.Vec2,this.offset=new pc.Vec2,this.scaling=new pc.Vec2,this.anchorOffset=new pc.Vec2,this.pivotOffset=new pc.Vec2;var t=this.app,s=t.graphicsDevice;if(!Sprite.shader){var i={attributes:{aPosition:pc.SEMANTIC_POSITION,aUv0:pc.SEMANTIC_TEXCOORD0},vshader:["attribute vec2 aPosition;","attribute vec2 aUv0;","varying vec2 vUv0;","uniform vec2 uResolution;","uniform vec2 uOffset;","uniform vec2 uScale;","","void main(void)","{","    gl_Position = vec4(2.0 * ((uScale * aPosition.xy + uOffset) / uResolution ) - 1.0, -0.9, 1.0);","    vUv0 = aUv0;","}"].join("\n"),fshader:["precision "+s.precision+" float;","","varying vec2 vUv0;","","uniform vec4 vTint;","","uniform sampler2D uColorMap;","","void main(void)","{","    vec4 color = texture2D(uColorMap, vUv0);","    gl_FragColor = vec4(color.rgb * vTint.rgb, color.a * vTint.a);","}"].join("\n")};Sprite.shader=new pc.Shader(s,i)}Sprite.vertexFormat||(Sprite.vertexFormat=new pc.VertexFormat(s,[{semantic:pc.SEMANTIC_POSITION,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32}])),this.texture=this.textureAsset.resource,this.vertexBuffer=new pc.VertexBuffer(s,Sprite.vertexFormat,6,pc.BUFFER_DYNAMIC),this.updateSprite();var r=new pc.Command(pc.LAYER_HUD,pc.BLEND_NORMAL,function(){this.entity.enabled&&(s.setShader(Sprite.shader),s.setBlending(!0),s.setBlendFunction(pc.BLENDMODE_SRC_ALPHA,pc.BLENDMODE_ONE_MINUS_SRC_ALPHA),s.setDepthWrite(!1),s.setDepthTest(!1),Sprite.resolution.set(e.offsetWidth,e.offsetHeight),s.scope.resolve("uResolution").setValue(Sprite.resolution.data),s.scope.resolve("uScale").setValue(this.calculateScaling().data),s.scope.resolve("uOffset").setValue(this.calculateOffset().data),s.scope.resolve("uColorMap").setValue(this.texture),s.scope.resolve("vTint").setValue(this.tint.data),s.setVertexBuffer(this.vertexBuffer,0),s.draw({type:pc.PRIMITIVE_TRIANGLES,base:0,count:6,indexed:!1}))}.bind(this));this.command=r,r.key=this.depth,t.scene.drawCalls.push(r),t.mouse.on("mousedown",this.onMouseDown,this),t.touch&&t.touch.on("touchstart",this.onTouchDown,this),this.on("state",this.onState),this.on("destroy",this.onDestroy,this),this.on("attr:depth",(function(e){this.eventsEnabled=!1,this.command.key=e})),this.on("attr:size",this.updateSprite),this.on("attr:uPercentage",this.updateSprite),this.on("attr:vPercentage",this.updateSprite),this.onState()},Sprite.prototype.onMouseDown=function(e){this.eventsEnabled&&this.onClick(e)},Sprite.prototype.onTouchDown=function(e){this.eventsEnabled&&this.onClick(e.changedTouches[0])},Sprite.prototype.onClick=function(e){var t,s,i,r,o,a,n=this.app.graphicsDevice.canvas,c=this.scaling,p=this.offset;t=2*(0*c.x+p.x)/Sprite.resolution.x-1,s=2*(0*c.y+p.y)/Sprite.resolution.y-1,i=2*(c.x*this.size.x+p.x)/Sprite.resolution.x-1,r=2*(c.y*-this.size.y+p.y)/Sprite.resolution.y-1,o=2*e.x/n.offsetWidth-1,a=2*(n.offsetHeight-e.y)/n.offsetHeight-1,o>=t&&o<=i&&a<=s&&a>=r&&this.fire("click")},Sprite.prototype.updateSprite=function(){if(this.vertexBuffer){this.eventsEnabled=!1,this.vertexBuffer.lock();this.app.graphicsDevice.canvas;var e=new pc.VertexIterator(this.vertexBuffer);e.element[pc.SEMANTIC_POSITION].set(0,-this.size.y),e.element[pc.SEMANTIC_TEXCOORD0].set(0,0),e.next(),e.element[pc.SEMANTIC_POSITION].set(this.size.x,-this.size.y),e.element[pc.SEMANTIC_TEXCOORD0].set(this.uPercentage,0),e.next(),e.element[pc.SEMANTIC_POSITION].set(0,0),e.element[pc.SEMANTIC_TEXCOORD0].set(0,this.vPercentage),e.next(),e.element[pc.SEMANTIC_POSITION].set(this.size.x,-this.size.y),e.element[pc.SEMANTIC_TEXCOORD0].set(this.uPercentage,0),e.next(),e.element[pc.SEMANTIC_POSITION].set(this.size.x,0),e.element[pc.SEMANTIC_TEXCOORD0].set(this.uPercentage,this.vPercentage),e.next(),e.element[pc.SEMANTIC_POSITION].set(0,0),e.element[pc.SEMANTIC_TEXCOORD0].set(0,this.vPercentage),this.vertexBuffer.unlock()}},Sprite.prototype.calculateOffset=function(){var e=this.app.graphicsDevice.canvas;return this.calculateAnchorOffset(),this.calculatePivotOffset(),this.offset.set(this.pos.x*this.scaling.x,this.pos.y*this.scaling.y).add(this.userOffset).add(this.anchorOffset).add(this.pivotOffset),this.offset.y+=e.offsetHeight,this.offset},Sprite.prototype.calculateScaling=function(){var e=this.app.graphicsDevice.canvas.offsetHeight/this.maxResHeight;return this.scaling.set(e,e),this.scaling},Sprite.prototype.calculateAnchorOffset=function(){var e=this.app.graphicsDevice.canvas,t=e.offsetWidth,s=e.offsetHeight;switch(this.anchor){case 0:this.anchorOffset.set(0,0);break;case 1:this.anchorOffset.set(.5*t,0);break;case 2:this.anchorOffset.set(t,0);break;case 3:this.anchorOffset.set(0,.5*-s);break;case 4:this.anchorOffset.set(.5*t,.5*-s);break;case 5:this.anchorOffset.set(t,.5*-s);break;case 6:this.anchorOffset.set(0,-s);break;case 7:this.anchorOffset.set(t/2,-s);break;case 8:this.anchorOffset.set(t,-s);break;default:console.error("Wrong anchor: "+this.anchor)}return this.anchorOffset},Sprite.prototype.calculatePivotOffset=function(){var e=this.size.x*this.scaling.x,t=this.size.y*this.scaling.y;switch(this.pivot){case 0:this.pivotOffset.set(0,0);break;case 1:this.pivotOffset.set(.5*-e,0);break;case 2:this.pivotOffset.set(-e,0);break;case 3:this.pivotOffset.set(0,.5*t);break;case 4:this.pivotOffset.set(.5*-e,.5*t);break;case 5:this.pivotOffset.set(-e,.5*t);break;case 6:this.pivotOffset.set(0,t);break;case 7:this.pivotOffset.set(-e/2,t);break;case 8:this.pivotOffset.set(-e,t);break;default:console.error("Wrong pivot: "+this.pivot)}return this.pivotOffset},Sprite.prototype.onState=function(e){this.eventsEnabled=!1},Sprite.prototype.update=function(e){this.eventsEnabled=!0},Sprite.prototype.onDestroy=function(){if(this.command){var e=this.app.scene.drawCalls.indexOf(this.command);e>=0&&this.app.scene.drawCalls.splice(e,1)}};var Input=pc.createScript("input");Input.prototype.initialize=function(){this.x=new pc.Vec3,this.z=new pc.Vec3,this.heading=new pc.Vec3,this.controller=new pc.Controller(window),this.controller.registerKeys("forward",[pc.KEY_UP,pc.KEY_W]),this.controller.registerKeys("back",[pc.KEY_DOWN,pc.KEY_S]),this.controller.registerKeys("left",[pc.KEY_LEFT,pc.KEY_A]),this.controller.registerKeys("right",[pc.KEY_RIGHT,pc.KEY_D]),this.controller.registerKeys("jump",[pc.KEY_SPACE]),this.camera=this.app.root.findByName("Camera"),this.character=this.entity,this.virtualSticks=this.app.root.findByName("Virtual Sticks")},Input.prototype.update=function(t){var i=!1;this.z.copy(this.camera.forward).scale(-1),this.z.y=0,this.z.normalize(),this.x.copy(this.camera.right),this.x.y=0,this.x.normalize(),this.heading.set(0,0,0),this.controller.isPressed("left")||this.virtualSticks.script.virtualSticks.leftX>0?(this.heading.sub(this.x),i=!0):(this.controller.isPressed("right")||this.virtualSticks.script.virtualSticks.leftX<0)&&(this.heading.add(this.x),i=!0),this.controller.isPressed("forward")||this.virtualSticks.script.virtualSticks.leftY>0?(this.heading.sub(this.z),i=!0):(this.controller.isPressed("back")||this.virtualSticks.script.virtualSticks.leftY<0)&&(this.heading.add(this.z),i=!0),i&&this.heading.normalize(),this.character.script.dynamicCharacterController.move(this.heading),this.controller.wasPressed("jump")&&this.character.script.dynamicCharacterController.jump()},Input.prototype.swap=function(t){};var DynamicCharacterController=pc.createScript("dynamicCharacterController");DynamicCharacterController.attributes.add("speed",{type:"number",default:5}),DynamicCharacterController.attributes.add("jumpImpulse",{type:"number",default:400}),DynamicCharacterController.prototype.initialize=function(){this.groundCheckRay=new pc.Vec3(0,-1.01,0),this.rayEnd=new pc.Vec3,this.onGround=!1,this.initialPos=this.entity.getPosition().clone(),this.initialRot=this.entity.getRotation().clone()},DynamicCharacterController.prototype.update=function(t){var i=this.entity.getPosition();this.rayEnd.add2(i,this.groundCheckRay),this.onGround=!1,this.app.systems.rigidbody.raycastFirst(i,this.rayEnd,function(t){this.onGround=!0}.bind(this))},DynamicCharacterController.prototype.reset=function(){this.entity.rigidbody.linearVelocity=pc.Vec3.ZERO,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO,this.entity.rigidbody.teleport(this.initialPos,this.initialRot)},DynamicCharacterController.prototype.move=function(t){this.onGround&&(t.scale(this.speed),this.entity.rigidbody.linearVelocity=t)},DynamicCharacterController.prototype.jump=function(){this.onGround&&(this.entity.rigidbody.applyImpulse(0,this.jumpImpulse,0),this.onGround=!1)},DynamicCharacterController.prototype.swap=function(t){};var FirstPersonCamera=pc.createScript("firstPersonCamera");FirstPersonCamera.prototype.initialize=function(){var t=this.app,i=this.entity.forward.clone();i.y=0,i.normalize(),this.azimuth=Math.atan2(-i.x,-i.z)*(180/Math.PI),(new pc.Mat4).setFromAxisAngle(pc.Vec3.UP,-this.azimuth).transformVector(this.entity.forward,i),this.elevation=Math.atan(i.y,i.z)*(180/Math.PI),t.mouse.disableContextMenu(),t.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),t.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.virtualSticks=t.root.findByName("Virtual Sticks")},FirstPersonCamera.prototype.update=function(t){var i=this.virtualSticks.script.virtualSticks.rightX,e=this.virtualSticks.script.virtualSticks.rightY;0!==i&&(this.azimuth+=i/2),0!==e&&(this.elevation+=e/2,this.elevation=pc.math.clamp(this.elevation,-90,90)),this.entity.setEulerAngles(this.elevation,this.azimuth,0)},FirstPersonCamera.prototype.onMouseMove=function(t){pc.Mouse.isPointerLocked()&&(this.elevation-=t.dy/5,this.elevation=pc.math.clamp(this.elevation,-90,90),this.azimuth-=t.dx/5)},FirstPersonCamera.prototype.onMouseDown=function(t){pc.Mouse.isPointerLocked()||this.app.mouse.enablePointerLock()},FirstPersonCamera.prototype.swap=function(t){};var Videotexture=pc.createScript("videotexture");Videotexture.attributes.add("materials",{type:"asset",assetType:"material",array:!0}),Videotexture.attributes.add("videoUrl",{type:"string"}),Videotexture.prototype.initialize=function(){var e=this.app,t=new pc.Texture(e.graphicsDevice,{format:pc.PIXELFORMAT_R5_G6_B5,autoMipmap:!1});t.minFilter=pc.FILTER_LINEAR,t.magFilter=pc.FILTER_LINEAR,t.addressU=pc.ADDRESS_CLAMP_TO_EDGE,t.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var i=document.createElement("video");i.addEventListener("canplay",(function(e){t.setSource(i)})),i.src=this.videoUrl,i.crossOrigin="anonymous",i.loop=!0,i.preload=!0,i.play();for(var a=0;a<this.materials.length;a++){var r=this.materials[a].resource;r.emissiveMap=t,r.update()}this.videoTexture=t,this.upload=!0},Videotexture.prototype.update=function(e){this.upload=!this.upload,this.upload&&this.videoTexture.upload()};var Npc=pc.createScript("npc");Npc.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3;this.app;this.entity.rigidbody&&this.entity.rigidbody.type===pc.BODYTYPE_DYNAMIC||console.error("NPC script needs to have a DYNAMIC 'rigidbody' component")},Npc.prototype.update=function(t){this.entity.translateLocal(.01,.1,1)};var Triggertext=pc.createScript("triggertext");Triggertext.attributes.add("artistname",{type:"string"}),Triggertext.attributes.add("artworkname",{type:"string"}),Triggertext.prototype.initialize=function(){this.artistname,this.artworkname;this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.entity.collision.on("collisionend",this.onCollisionEnd,this)},Triggertext.prototype.onCollisionStart=function(t){t.other.rigidbody&&(this.app.root.findByName("artistnameUI").element.text=this.artistname,this.app.root.findByName("artworkUI").element.text=this.artworkname)},Triggertext.prototype.onCollisionEnd=function(t){this.app.root.findByName("artistnameUI").element.text="",this.app.root.findByName("artworkUI").element.text=""},Triggertext.prototype.update=function(t){};var Ui=pc.createScript("ui");Ui.prototype.initialize=function(){},Ui.prototype.update=function(i){};var Triggermat=pc.createScript("triggermat");Triggermat.attributes.add("mattext",{type:"string"}),Triggermat.prototype.initialize=function(){this.mattext;this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.entity.collision.on("collisionend",this.onCollisionEnd,this)},Triggermat.prototype.onCollisionStart=function(t){t.other.rigidbody&&(this.app.root.findByName("matUI").element.text=this.mattext)},Triggermat.prototype.onCollisionEnd=function(t){this.app.root.findByName("matUI").element.text=""},Triggermat.prototype.update=function(t){};var Loaddesktop=pc.createScript("loaddesktop");Loaddesktop.attributes.add("sceneId",{type:"string",default:"0",title:"Scene ID to Load"}),Loaddesktop.prototype.initialize=function(){this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},Loaddesktop.prototype.onPress=function(t){this.app.root.findByName("Root").destroy(),this.loadScene(this.sceneId,(function(){}))},Loaddesktop.prototype.update=function(t){},Loaddesktop.prototype.loadScene=function(t,e){var o=t+".json";this.app.loadSceneHierarchy(o,(function(t,o){t?console.error(t):e(o)}))};